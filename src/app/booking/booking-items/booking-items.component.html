<div class="container">
  <h1 id="title">Customer Form</h1>
  <p id="description">Please fill the customer details.</p>
  <div class="row">
    <div class="col-75">
      <div class="container">
          <fieldset *ngIf="!showItems">
            <legend>Add Items</legend>
            <button mat-raised-button color="primary" style="margin-right:5px; width: 20%; background-color: #004e92;" *ngIf="!showItems"
              (click)="onShowItems()">Add Items</button>
          </fieldset>
          <mat-accordion [multi]="true">
            <mat-expansion-panel *ngIf="showItems" hideToggle [expanded]="true">
              <mat-expansion-panel-header>
                <mat-panel-title>Payment Details</mat-panel-title>
              </mat-expansion-panel-header>
              <form id="survey-form" [formGroup]="paymentForm">
                <fieldset>
                  <legend>Payment</legend>
                  <div>
                    <label class="required">Type</label>
                    <app-material-select-input [label]="'Payment type'"  [width]="30" [options]="paymentTypes" formControlName="paymentType"
                    (selectionChange)="onSelectionChange($event, 'paymentType', 0)" [value]="paymentTypes[0]"></app-material-select-input>
                    <label class="required">Status</label>
                    <app-material-select-input [label]="'Payment status'"  [width]="30" [options]="paymentStatuses" formControlName="paymentStatus"
                    (selectionChange)="onSelectionChange($event, 'paymentStatus', 0)" [value]="paymentStatuses[0]"></app-material-select-input>
                  </div>
                </fieldset>
              </form>
            </mat-expansion-panel>
            <mat-expansion-panel  *ngIf="showItems" [expanded]="false">
              <mat-expansion-panel-header>
                <mat-panel-title>Items Details</mat-panel-title>
              </mat-expansion-panel-header>
                <form id="survey-form" [formGroup]="bookingItemForm">
                  <fieldset>
                    <legend>Totals</legend>
                    <div>
                     <p>Total number of items: {{getTotalNumberOfItems()}} </p><br>
                     <p>Total amount: £{{getTotalAmount()}} </p>
                    </div>
                  </fieldset>
                  <div formArrayName="items" *ngFor="let item of items.controls; let i = index">
                    <div [formGroupName] = 'i' >
                      <fieldset>
                        <legend>Item Information</legend>
                        <div>
                          <label class="required">Quantity</label>
                          <app-material-numeric-input [label]="'Number of Items'" (inputChange)='onInputChange($event, i)' formControlName="quantity"></app-material-numeric-input>
                          <label class="required">Type</label>
                          <app-material-select-input [width]="15" [options]="types" formControlName="type"
                          (selectionChange)="onSelectionChange($event, 'type', i)" [value]="types[0]"></app-material-select-input>
                          <label class="required" *ngIf = "showDesc(i)">Description</label>
                          <app-material-input  *ngIf = "showDesc(i)"  [icon]="'person_pin'" [width]="25" formControlName="description"></app-material-input>
                          <label class="required">Value(£)</label>
                          <app-material-input [icon]="'person_pin'" [width]="10" formControlName="value"></app-material-input>
                          <label class="required">Price per unit(£)</label>
                          <app-material-input [label]="'Price per unit(£)'" [icon]="'person_pin'" [width]="10"  formControlName="pricePerUnit"></app-material-input>
                          <label class="required">Total(£)</label>
                          <app-material-input [label]="'Total(£)'" [icon]="'person_pin'" [width]="10"  formControlName="amount"></app-material-input>
                        </div>
                      </fieldset>
                    </div>
                    <br>
                    <app-material-button [label]="'-'" [color]="'primary'" [backgroundColor]="'#c43b00'" (click)="onDeleteItem(i)"></app-material-button>
                    <div class="divider"></div>
                    <app-material-button [label]="'+'" [color]="'primary'" [backgroundColor]="'#004e92'" [disabled]="isItemValuePopulated(i)" (click)="onAddItem(i)"></app-material-button>
                  </div>
                </form>
            </mat-expansion-panel>
          </mat-accordion>
      </div>
    </div>
  </div>
</div>
